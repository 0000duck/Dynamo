<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  
  <Product Id="*" 
           Name="Dynamo" 
           Language="1033" 
           Version="0.7.1" 
           Manufacturer="Dynamo" 
           UpgradeCode="f84e2239-049c-43cb-b875-ada28893a9db">
    
    <Package InstallerVersion="200" 
             Compressed="yes" 
             InstallScope="perMachine" 
             Platform="x64"/>

    <MajorUpgrade 
      Schedule="afterInstallInitialize"
      DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    
    <MediaTemplate />

    <Feature Id="DYNAMO_CORE_FEATURE" Title="Dynamo Core" Level="1">
      <ComponentGroupRef Id="RELEASE"/>
      <ComponentGroupRef Id="SAMPLES"/>
      <ComponentGroupRef Id="DEFINITIONS"/>
    </Feature>

    <Icon Id="DynamoInstaller.ico" SourceFile="$(var.SolutionDir)..\tools\install\Extra\DynamoInstaller.ico"/>
    <Property Id="ARPPRODUCTICON" Value="DynamoInstaller.ico" />

    <!--http://wix.tramontana.co.hu/tutorial/getting-started/where-to-install-->
    <Property Id="DYNAMO_INSTALLDIR">
      <RegistrySearch Id='Revit2015Registry' Type='raw' Win64='yes'
        Root='HKLM' Key='SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Autodesk Revit Architecture 2015' Name='InstallLocation' />
    </Property>
    
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
        <Directory Id="DYNAMO_INSTALLDIR">
        </Directory>
      <Directory Id="CommonAppDataFolder">
        <Directory Id="DYNAMO_PROGDATA" Name="Dynamo">
          <Directory Id="PROGDATA_07" Name="0.7"/>
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <!--Notes about working with x64-->
  <!--http://msdn.microsoft.com/en-us/library/gg513929.aspx-->
  <Fragment>
    
    <!--<ComponentGroup Id="DYNAMO_CORE" Directory="APPLICATIONROOTDIRECTORY">
      <Component Id="DynamoSandbox.exe" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoSandbox.exe" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoSandbox.exe.config" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoSandbox.exe.config" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="InstallUpdate.exe" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\InstallUpdate.exe" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="InstallUpdate.exe.config" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\InstallUpdate.exe.config" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoTestConsoleRunner.exe" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoTestConsoleRunner.exe" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="CSharpAnalytics.WinForms.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\CSharpAnalytics.WinForms.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSCoreNodes.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSCoreNodes.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSCoreNodes.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSCoreNodes.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSCoreNodes_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSCoreNodes_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSIronPython.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSIronPython.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSIronPython_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSIronPython_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSNodeServices.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSNodeServices.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSOffice.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSOffice.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSOffice_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DSOffice_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoArduino.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoArduino.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoArduino.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoArduino.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoCore.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoCore.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoCrypto.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoCrypto.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoMSOffice.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoMSOffice.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoPython.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoPython.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoPython.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoPython.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoUnits.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoUnits.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoUnits_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoUnits_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoUtilities.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\DynamoUtilities.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="FFITarget.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\FFITarget.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="GraphLayout.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\GraphLayout.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="GraphToDSCompiler.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\GraphToDSCompiler.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Greg.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Greg.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="HelixToolkit.Wpf.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\HelixToolkit.Wpf.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="HelixToolkit.Wpf.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\HelixToolkit.Wpf.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ICSharpCode.AvalonEdit.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ICSharpCode.AvalonEdit.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Ionic.Zip.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Ionic.Zip.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="MIConvexHullPlugin.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\MIConvexHullPlugin.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Microsoft.Office.Interop.Excel.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Microsoft.Office.Interop.Excel.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Microsoft.Practices.Prism.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Microsoft.Practices.Prism.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Microsoft.Scripting.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Microsoft.Scripting.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Microsoft.Vbe.Interop.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Microsoft.Vbe.Interop.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Moq.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Moq.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="NCalc.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\NCalc.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Newtonsoft.Json.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Newtonsoft.Json.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="nunit.framework.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\nunit.framework.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Office.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Office.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoAssociative.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoAssociative.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoCore.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoCore.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoGeometry.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoGeometry.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoGeometry.config" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoGeometry.config" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoGeometry.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoGeometry.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoGeometry_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoGeometry_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoImperative.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoImperative.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoInterface.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoInterface.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoScript.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoScript.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoScript.dll.config" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoScript.dll.config" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoTest.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoTest.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ProtoTestFx.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\ProtoTestFx.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RestSharp.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\RestSharp.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SimplexNoise.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\SimplexNoise.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="System.Net.Http.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\System.Net.Http.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="System.Windows.Interactivity.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\System.Windows.Interactivity.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Tessellation.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Tessellation.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Tessellation_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Tessellation_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="VMDataBridge.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\VMDataBridge.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="WorkflowTests.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\WorkflowTests.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Flatten.ds" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Flatten.ds" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="FunctionObject.ds" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\FunctionObject.ds" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Optimize.ds" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Optimize.ds" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="License.rtf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\License.rtf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Dynamo.cer" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Dynamo.cer" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>
    
    <ComponentGroup Id="DYNAMO_CORE_NODES" Directory="NODES_DIRECTORY">
      <Component Id="DSCoreNodesUI.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\nodes\DSCoreNodesUI.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DSIronPythonNode.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\nodes\DSIronPythonNode.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoWatch3D.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\nodes\DynamoWatch3D.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Migrations.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\nodes\Migrations.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SamplesLibraryUI.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\nodes\SamplesLibraryUI.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="UnitsUI.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\nodes\UnitsUI.dll" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="DYNAMO_LIBG_219" Directory="LIBG_219_DIRECTORY">
      <Component Id="boost_chrono_vc100_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\boost_chrono-vc100-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="boost_regex_vc100_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\boost_regex-vc100-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="boost_system_vc100_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\boost_system-vc100-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="boost_thread_vc100_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\boost_thread-vc100-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibG.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\LibG.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibG.Managed.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\LibG.Managed.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibG.ProtoInterface.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\LibG.ProtoInterface.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibGCore.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\LibGCore.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="msvcp100.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\msvcp100.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="msvcr100.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_219\msvcr100.dll" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="DYNAMO_LIBG_220" Directory="LIBG_220_DIRECTORY">
      <Component Id="boost_chrono_vc110_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_220\boost_chrono-vc110-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="boost_regex_vc110_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_220\boost_regex-vc110-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="boost_system_vc110_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_220\boost_system-vc110-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="boost_thread_vc110_mt_1_51.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_220\boost_thread-vc110-mt-1_51.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibG.220.dll" Win64="yes">
        <File Id="LibG_220" Source="$(var.DynamoCore.TargetDir)\libg_220\LibG.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibG.Managed.220.dll" Win64="yes">
        <File Id="LibGManaged_220" Source="$(var.DynamoCore.TargetDir)\libg_220\LibG.Managed.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibG.ProtoInterface.220.dll" Win64="yes">
        <File Id="LibGProtoInterface_220" Source="$(var.DynamoCore.TargetDir)\libg_220\LibG.ProtoInterface.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="LibGCore.220.dll" Win64="yes">
        <File Id="LibGCore_220" Source="$(var.DynamoCore.TargetDir)\libg_220\LibGCore.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="msvcp110.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_220\msvcp110.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="msvcr110.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\libg_220\msvcr110.dll" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="DYNAMO_UI_FONTS" Directory="UI_FONTS_DIRECTORY">
      <Component Id="OpenSans_Bold.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-Bold.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_BoldItalic.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-BoldItalic.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_ExtraBold.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-ExtraBold.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_ExtraBoldItalic.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-ExtraBoldItalic.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_Italic.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-Italic.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_Light.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-Light.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_LightItalic.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-LightItalic.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_Regular.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-Regular.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_Semibold.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-Semibold.ttf" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="OpenSans_SemiboldItalic.ttf" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Fonts\OpenSans-SemiboldItalic.ttf" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="DYNAMO_UI_THEMES" Directory="UI_THEMES_MODERN_DIRECTORY">
      <Component Id="Connectors.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\Connectors.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DataTemplates.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\DataTemplates.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoColorsAndBrushes.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\DynamoColorsAndBrushes.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoConverters.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\DynamoConverters.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoModern.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\DynamoModern.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoText.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\DynamoText.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="MenuStyleDictionary.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\MenuStyleDictionary.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="Ports.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\Ports.xaml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="ToolbarStyleDictionary.xaml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\UI\Themes\Modern\ToolbarStyleDictionary.xaml" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>
    
    <ComponentGroup Id="REVIT_2014" Directory="REVIT_2014_DIRECTORY">
      <Component Id="DynamoRaaSHelper.2014.dll" Win64="yes">
        <File Id="DynamoRaasHelper_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\DynamoRaaSHelper.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRevitDS.2014.dll" Win64="yes">
        <File Id="DynamoRevitDS_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\DynamoRevitDS.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRevitDS.2014.xml" Win64="yes">
        <File Id="DynamoRevitDSxml_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\DynamoRevitDS.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRevitVersionSelector.2014.dll" Win64="yes">
        <File Id="DynamoRevitVersionSelector_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\DynamoRevitVersionSelector.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="GregRevitAuth.2014.dll" Win64="yes">
        <File Id="GregRevitAuth_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\GregRevitAuth.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="JobMonitor.2014.dll" Win64="yes">
        <File Id="JobMonitor_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\JobMonitor.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitNodes.2014.dll" Win64="yes">
        <File Id="RevitNodes_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\RevitNodes.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitNodes.2014.xml" Win64="yes">
        <File Id="RevitNodesxml_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\RevitNodes.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitNodes_DynamoCustomization.2014.2014.xml" Win64="yes">
        <File Id="RevitNodesCustomization_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\RevitNodes_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitRaaS.2014.dll" Win64="yes">
        <File Id="RevitRaas_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\RevitRaaS.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitRaaS.dll.2014.config" Win64="yes">
        <File Id="RevitRaasconfig_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\RevitRaaS.dll.config" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitServices.2014.dll" Win64="yes">
        <File Id="RevitServices_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\RevitServices.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitTestFrameworkTypes.2014.dll" Win64="yes">
        <File Id="RevitTestFrameworkTypes_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\RevitTestFrameworkTypes.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SDF.2014.dll" Win64="yes">
        <File Id="SDF_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\SDF.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SimpleRaaS.2014.dll" Win64="yes">
        <File Id="SimpleRaas_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\SimpleRaaS.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SimpleRaaS_DynamoCustomization.2014.xml" Win64="yes">
        <File Id="SimpleRaasCustomization_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\SimpleRaaS_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>
    
    <ComponentGroup Id="REVIT_2014_NODES" Directory="REVIT_2014_NODES_DIRECTORY">
      <Component Id="DSRevitNodesUI.2014.dll" Win64="yes">
        <File Id="DSRevitNodesUI_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\nodes\DSRevitNodesUI.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRaaS.2014.dll" Win64="yes">
        <File Id="DynamoRaas_2014" 
              Source="$(var.DynamoCore.TargetDir)\Revit_2014\nodes\DynamoRaaS.dll" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="REVIT_2015" Directory="REVIT_2015_DIRECTORY">
      <Component Id="DynamoRaaSHelper.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\DynamoRaaSHelper.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRevitDS.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\DynamoRevitDS.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRevitDS.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\DynamoRevitDS.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRevitVersionSelector.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\DynamoRevitVersionSelector.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="GregRevitAuth.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\GregRevitAuth.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="JobMonitor.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\JobMonitor.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitNodes.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\RevitNodes.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitNodes.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\RevitNodes.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitNodes_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\RevitNodes_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitRaaS.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\RevitRaaS.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitRaaS.dll.config" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\RevitRaaS.dll.config" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitServices.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\RevitServices.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="RevitTestFrameworkTypes.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\RevitTestFrameworkTypes.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SDF.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\SDF.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SimpleRaaS.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\SimpleRaaS.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="SimpleRaaS_DynamoCustomization.xml" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\SimpleRaaS_DynamoCustomization.xml" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>
    
    <ComponentGroup Id="REVIT_2015_NODES" Directory="REVIT_2015_NODES_DIRECTORY">
      <Component Id="DSRevitNodesUI.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\nodes\DSRevitNodesUI.dll" ProcessorArchitecture="x64"/>
      </Component>
      <Component Id="DynamoRaaS.dll" Win64="yes">
        <File Source="$(var.DynamoCore.TargetDir)\Revit_2015\nodes\DynamoRaaS.dll" ProcessorArchitecture="x64"/>
      </Component>
    </ComponentGroup>-->
    
  </Fragment>

</Wix>